<!-- portal.html -->
{% extends 'Layouts/layout.html' %}
{% load static %}
{% block title %}
Panel de control
{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item">
    Panel de control
</li>
<li class="breadcrumb-item active" aria-current="page">
    Principal
</li>
{% endblock %}

{% block content %}
<div class="container-fluid">

    <div class="row justify-content-center">
        <div class="col-lg-10 col-12">
            <div class="card shadow-lg rounded-4">
                <!-- Header de la Card -->
                <div class="card-header bg-dark text-white text-center rounded-top">
                    <h4 class="mb-0">
                        <i class="fa-solid fa-house pe-2"></i> ¡Bienvenid@ al Panel de Control!
                    </h4>
                </div>
    
                <!-- Contenido Principal -->
                <div class="card-body p-4">
                    <p class="text-center">
                        Gestiona y supervisa el sistema en tiempo real con acceso a información clave 
                        sobre <strong>pagos</strong>, <strong>recibos</strong>, <strong>contribuyentes</strong> y <strong>propiedades</strong>. 
                        Mantente informado y optimiza la administración con herramientas dinámicas.
                    </p>
    
                    <hr>
    
                    <!-- Secciones de Información -->
                    <div class="row text-center">
                        <div class="col-md-6">
                            <h5 class="fw-bold"><i class="fa-solid fa-chart-simple pe-2"></i> Estadísticas</h5>
                            <p class="small text-muted">
                                Obtén métricas detalladas sobre pagos y recibos diarios, mensuales y anuales. 
                                Analiza tendencias con gráficos interactivos y toma decisiones basadas en datos.
                            </p>
                        </div>
                        <div class="col-md-6">
                            <h5 class="fw-bold"><i class="fa-solid fa-file-alt pe-2"></i> Reportes</h5>
                            <p class="small text-muted">
                                Accede a informes detallados que te permitirán monitorear la actividad del sistema, 
                                optimizar la gestión de recursos y mejorar la administración.
                            </p>
                        </div>
                    </div>
    
                    <hr>
    
                    <!-- Mensaje Final -->
                    <p class="mb-0 text-center">
                        Aprovecha al máximo las herramientas del sistema para mejorar tu flujo de trabajo. 
                        Para asistencia o más información, consulta la documentación oficial.
                    </p>
                </div>
            </div>
        </div>
    </div>
        
    


    <div class="row justify-content-md-center">

        <!-- Pagos Hoy -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-blue">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Pagos Totales Realizados Hoy</h5>
                    <p class="card-text custom-card-text">{{ pagos_hoy }}</p>
                </div>
            </div>
        </div>

        <!-- Pagos del Mes -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-blue">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Pagos Totales Realizados en el Mes</h5>
                    <p class="card-text custom-card-text">{{ pagos_mes }}</p>
                </div>
            </div>
        </div>

        <!-- Pagos del Año -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-blue">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Pagos Totales Realizados en el Año</h5>
                    <p class="card-text custom-card-text">{{ pagos_anio }}</p>
                </div>
            </div>
        </div>

        <!-- Suma Pagos Hoy -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-orange">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Suma Total de Pagos de Hoy</h5>
                    <p class="card-text custom-card-text">${{ suma_pagos_hoy }}</p>
                </div>
            </div>
        </div>

        <!-- Suma Pagos del Mes -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-orange">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Suma Total de Pagos del Mes</h5>
                    <p class="card-text custom-card-text">${{ suma_pagos_mes }}</p>
                </div>
            </div>
        </div>

        <!-- Suma Pagos del Año -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-orange">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Suma Total de Pagos del Año</h5>
                    <p class="card-text custom-card-text">${{ suma_pagos_anio }}</p>
                </div>
            </div>
        </div>

        <!-- Recibos Hoy -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-green">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Recibos Totales de Hoy</h5>
                    <p class="card-text custom-card-text">{{ recibos_hoy }}</p>
                </div>
            </div>
        </div>

        <!-- Recibos del Mes -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-green">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Recibos Totales del Mes</h5>
                    <p class="card-text custom-card-text">{{ recibos_mes }}</p>
                </div>
            </div>
        </div>

        <!-- Recibos del Año -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-green">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Recibos Totales del Año</h5>
                    <p class="card-text custom-card-text">{{ recibos_anio }}</p>
                </div>
            </div>
        </div>

        <!-- Contribuyentes Registrados Hoy -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-purple">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Contribuyentes Registrados Hoy</h5>
                    <p class="card-text custom-card-text">{{ contribuyentes_hoy }}</p>
                </div>
            </div>
        </div>

        <!-- Contribuyentes Registrados en el Mes -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-purple">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Contribuyentes Registrados en el Mes</h5>
                    <p class="card-text custom-card-text">{{ contribuyentes_mes }}</p>
                </div>
            </div>
        </div>

        <!-- Total Contribuyentes Registrados -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-purple">
                <div class="card-body">
                    <h5 class="card-title custom-card-title">Total de Contribuyentes Registrados</h5>
                    <p class="card-text custom-card-text">{{ contribuyentes_total }}</p>
                </div>
            </div>
        </div>

        <!-- Total de Propiedades -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-red">
                <div class="card-body">
                    <h5 class="card-title custom-card-title"><i class="fa fa-building" aria-hidden="true"></i></h5>
                    <h5 class="card-title custom-card-title">Total de Propiedades</h5>
                    <p class="card-text custom-card-text">{{ total_propiedades }}</p>
                </div>
            </div>
        </div>

        <!-- Tarifas Activas -->
        <div class="col-12 col-md-4 col-sm-6">
            <div class="card custom-card card-border-cyan">
                <div class="card-body">
                    <h5 class="card-title custom-card-title"><i class="fa fa-file-text" aria-hidden="true"></i></i></h5>
                    <h5 class="card-title custom-card-title">Tarifas Activas</h5>
                    <p class="card-text custom-card-text">{{ tarifas_activas }}</p>
                </div>
            </div>
        </div>

    </div>

    <div class="row justify-content-center">
        <div class="col-12 col-lg-6">
            <!-- Aqui grafica de suma totales de pagos de todos los recibos por mes de todo el año actual -->
            <div class="card custom-card card-border-red">
                <div class="card-body">

                    <canvas id="pagosPorMesChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-12 col-lg-6">
            <!-- Aqui grafica de suma totales de recibos  por mes de todo el año actual -->
            <div class="card custom-card card-border-cyan">
                <div class="card-body">
                    <canvas id="recibosPorMesChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js-page %}

<script type="text/javascript" src="{% static 'js/Chart.min.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        fetch("{% url 'pagos_por_mes_chart' %}")
        .then(response => response.json())
        .then(data => {
            const backgroundColors = [
                "#FF6384", "#36A2EB", "#FFCE56", "#4BC0C0", "#9966FF", "#FF9F40",
                "#C9CBCF", "#60D394", "#D36060", "#6A0572", "#F8B400", "#B20600"
            ];

            // Agregar colores al dataset
            data.datasets[0].backgroundColor = backgroundColors;

            new Chart(document.getElementById('pagosPorMesChart'), {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: data.datasets
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Pagos Mensuales'
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });

        fetch("{% url 'recibos_por_mes_chart' %}")
            .then(response => response.json())
            .then(data => {
                new Chart(document.getElementById('recibosPorMesChart'), {
                    type: 'line',
                    data: {
                        labels: data.labels,
                        datasets: data.datasets
                    },
                    options: {
                        responsive: true,
                        title: {
                            display: true,
                            text: 'Recibos Mensuales'
                        },
                    }

                });
            });
    });

</script>
{% endblock %}